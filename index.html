<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detektor Harga Emas Real-time dari Berbagai Sumber</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .live-badge {
            display: inline-block;
            background-color: #e74c3c;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .data-source-info {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .source-badge {
            background-color: #3498db;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status-container {
            display: flex;
            justify-content: center;
            align-items: stretch;
            margin: 25px 0;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .status-card {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            min-width: 280px;
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
        }
        
        .price-container {
            margin-bottom: 25px;
            flex-grow: 1;
        }
        
        .current-price {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .currency {
            color: #7f8c8d;
            font-size: 1.2rem;
        }
        
        .price-change {
            font-size: 1.2rem;
            font-weight: 600;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .positive {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }
        
        .negative {
            background-color: rgba(231, 76, 60, 0.2);
            color: #c0392b;
        }
        
        .indicator {
            margin: 20px 0;
            padding: 15px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all 0.5s ease;
        }
        
        .safe {
            background-color: rgba(46, 204, 113, 0.15);
            border-left: 5px solid #2ecc71;
        }
        
        .unsafe {
            background-color: rgba(231, 76, 60, 0.15);
            border-left: 5px solid #e74c3c;
        }
        
        .indicator-icon {
            font-size: 2.2rem;
        }
        
        .safe .indicator-icon {
            color: #27ae60;
        }
        
        .unsafe .indicator-icon {
            color: #c0392b;
        }
        
        .indicator-text {
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .chart-title {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .timeframe-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .timeframe-btn {
            padding: 8px 15px;
            border: none;
            background-color: #ecf0f1;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }
        
        .timeframe-btn.active {
            background-color: #3498db;
            color: white;
        }
        
        .timeframe-btn:hover:not(.active) {
            background-color: #d5dbdb;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .info-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-list {
            list-style-type: none;
        }
        
        .info-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
        }
        
        .info-list li:last-child {
            border-bottom: none;
        }
        
        .label {
            color: #7f8c8d;
        }
        
        .value {
            font-weight: 600;
        }
        
        .sources-container {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .sources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .source-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border: 1px solid #ecf0f1;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .source-item:hover {
            background-color: #f8f9fa;
            transform: translateY(-3px);
        }
        
        .source-logo {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
            border-radius: 10px;
            font-size: 1.5rem;
            color: #3498db;
        }
        
        .source-info {
            flex-grow: 1;
        }
        
        .source-name {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .source-status {
            font-size: 0.8rem;
            color: #7f8c8d;
        }
        
        .source-status.active {
            color: #27ae60;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .update-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
        }
        
        .auto-update {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #27ae60;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .last-update {
            margin-top: 10px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .status-container {
                flex-direction: column;
            }
            
            .current-price {
                font-size: 2.2rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .chart-title {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-gem"></i> Detektor Harga Emas Real-time</h1>
            <p class="subtitle">Data langsung dari berbagai sumber terpercaya <span class="live-badge">LIVE</span></p>
            <div class="data-source-info">
                <div class="source-badge">
                    <i class="fas fa-sync-alt"></i> Update Otomatis
                </div>
                <div class="source-badge">
                    <i class="fas fa-database"></i> 8 Sumber Data
                </div>
                <div class="source-badge">
                    <i class="fas fa-bolt"></i> Real-time
                </div>
            </div>
        </header>
        
        <div class="status-container">
            <div class="status-card">
                <div class="price-container">
                    <div class="label">Harga Emas Rata-rata</div>
                    <div class="current-price">
                        <span class="currency">Rp</span> 
                        <span id="gold-price">1,025,800</span>
                    </div>
                    <div class="price-change positive" id="price-change">
                        <i class="fas fa-arrow-up"></i> Rp 4,500 (+0.44%)
                    </div>
                    <div class="label" style="margin-top: 15px;">
                        <i class="fas fa-calculator"></i> Dari 8 sumber terpercaya
                    </div>
                </div>
                
                <div class="indicator safe" id="market-indicator">
                    <div class="indicator-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="indicator-text">Pasar Stabil</div>
                </div>
            </div>
            
            <div class="status-card">
                <div class="price-container">
                    <div class="label">Rentang Harga Hari Ini</div>
                    <div style="margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span class="label">Tertinggi</span>
                            <span class="value positive" id="highest-price">Rp 1,028,500</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span class="label">Terendah</span>
                            <span class="value" id="lowest-price">Rp 1,023,200</span>
                        </div>
                    </div>
                    
                    <div style="background-color: #ecf0f1; height: 10px; border-radius: 5px; margin: 20px 0; position: relative;">
                        <div id="price-range-bar" style="background-color: #3498db; height: 100%; border-radius: 5px; width: 65%;"></div>
                        <div id="current-price-marker" style="position: absolute; top: -5px; width: 3px; height: 20px; background-color: #2c3e50; left: 65%;"></div>
                    </div>
                    
                    <div class="label">
                        <i class="fas fa-info-circle"></i> Selisih: <span id="price-difference">Rp 5,300</span>
                    </div>
                </div>
            </div>
            
            <div class="status-card">
                <h3><i class="fas fa-chart-line"></i> Indikator Pasar</h3>
                <div class="info-list">
                    <li>
                        <span class="label">Volatilitas</span>
                        <span class="value" id="volatility">Sedang</span>
                    </li>
                    <li>
                        <span class="label">Trend 24 Jam</span>
                        <span class="value positive" id="trend">Naik</span>
                    </li>
                    <li>
                        <span class="label">Risiko</span>
                        <span class="value" id="risk">Rendah</span>
                    </li>
                    <li>
                        <span class="label">Konsensus</span>
                        <span class="value positive" id="consensus">Stabil</span>
                    </li>
                </div>
                
                <div class="update-status">
                    <div class="auto-update">
                        <span class="label">Auto-update</span>
                        <label class="switch">
                            <input type="checkbox" id="auto-update-toggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="last-update" id="update-timer">
                        0 detik lalu
                    </div>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">
                <span>Grafik Harga Emas 24 Jam Terakhir</span>
                <div class="timeframe-selector">
                    <button class="timeframe-btn active" onclick="changeTimeframe('24h')">24 Jam</button>
                    <button class="timeframe-btn" onclick="changeTimeframe('7d')">7 Hari</button>
                    <button class="timeframe-btn" onclick="changeTimeframe('30d')">30 Hari</button>
                </div>
            </div>
            <canvas id="goldChart"></canvas>
        </div>
        
        <div class="sources-container">
            <h3><i class="fas fa-satellite-dish"></i> Sumber Data Real-time</h3>
            <p>Data dikumpulkan dari berbagai sumber terpercaya secara langsung:</p>
            
            <div class="sources-grid" id="sources-list">
                <!-- Sumber data akan dimuat di sini -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Memuat sumber data...
                </div>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-card">
                <h3><i class="fas fa-info-circle"></i> Tentang Sistem</h3>
                <p>Sistem ini mengumpulkan data harga emas dari berbagai sumber terpercaya dan menganalisisnya secara real-time:</p>
                <ul class="info-list" style="margin-top: 15px;">
                    <li>
                        <span class="label"><i class="fas fa-check-circle" style="color:#27ae60"></i> Data langsung</span>
                        <span class="value">Dari 8+ sumber</span>
                    </li>
                    <li>
                        <span class="label"><i class="fas fa-sync-alt" style="color:#3498db"></i> Update</span>
                        <span class="value">Setiap 10 detik</span>
                    </li>
                    <li>
                        <span class="label"><i class="fas fa-chart-bar" style="color:#9b59b6"></i> Analisis</span>
                        <span class="value">Real-time</span>
                    </li>
                    <li>
                        <span class="label"><i class="fas fa-bell" style="color:#e74c3c"></i> Notifikasi</span>
                        <span class="value">Perubahan signifikan</span>
                    </li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-history"></i> Perubahan Terkini</h3>
                <div id="recent-changes">
                    <!-- Perubahan akan dimuat di sini -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> Memuat perubahan...
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Data harga emas dikumpulkan dari berbagai sumber terpercaya dan diperbarui secara real-time</p>
            <p class="last-update">Terakhir diperbarui: <span id="last-update">Sabtu, 31 Jan 2026 10:30:15 WIB</span></p>
            <p style="margin-top: 10px;">¬© 2026 Detektor Harga Emas Real-time. Data untuk keperluan informatif.</p>
        </footer>
    </div>

    <script>
        // Data harga emas dari berbagai sumber (simulasi)
        const goldSources = [
            { id: 1, name: "Antam", price: 1025500, change: 0.42, status: "active", color: "#e74c3c", icon: "fas fa-landmark" },
            { id: 2, name: "Logam Mulia", price: 1024800, change: 0.38, status: "active", color: "#3498db", icon: "fas fa-gem" },
            { id: 3, name: "Pegadaian", price: 1026200, change: 0.51, status: "active", color: "#2ecc71", icon: "fas fa-university" },
            { id: 4, name: "Bloomberg", price: 1024300, change: 0.35, status: "active", color: "#9b59b6", icon: "fas fa-chart-line" },
            { id: 5, name: "Kitco", price: 1025100, change: 0.45, status: "active", color: "#f39c12", icon: "fas fa-globe" },
            { id: 6, name: "Reuters", price: 1025900, change: 0.48, status: "active", color: "#1abc9c", icon: "fas fa-newspaper" },
            { id: 7, name: "Gold Price", price: 1024000, change: 0.32, status: "active", color: "#34495e", icon: "fas fa-coins" },
            { id: 8, name: "XE.com", price: 1025300, change: 0.41, status: "active", color: "#e67e22", icon: "fas fa-money-bill-wave" }
        ];
        
        // Data historis untuk grafik
        const historicalData = {
            '24h': {
                labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', 'Sekarang'],
                prices: [1021300, 1022500, 1023800, 1024500, 1025200, 1026000, 1025800],
                color: '#3498db'
            },
            '7d': {
                labels: ['24 Jan', '25 Jan', '26 Jan', '27 Jan', '28 Jan', '29 Jan', '30 Jan', '31 Jan'],
                prices: [1012000, 1015000, 1018000, 1019500, 1021500, 1019000, 1020300, 1025800],
                color: '#2ecc71'
            },
            '30d': {
                labels: ['1 Jan', '5 Jan', '10 Jan', '15 Jan', '20 Jan', '25 Jan', '30 Jan', '31 Jan'],
                prices: [985000, 995000, 1005000, 1010000, 1018000, 1021000, 1020300, 1025800],
                color: '#9b59b6'
            }
        };
        
        // Variabel global
        let chart;
        let currentTimeframe = '24h';
        let autoUpdate = true;
        let updateInterval;
        let lastUpdateTime = new Date();
        let updateCount = 0;
        
        // Inisialisasi grafik
        function initChart() {
            const ctx = document.getElementById('goldChart').getContext('2d');
            const data = historicalData[currentTimeframe];
            
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Harga Emas (Rp/gram)',
                        data: data.prices,
                        borderColor: data.color,
                        backgroundColor: data.color + '20',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 4,
                        pointBackgroundColor: data.color
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0,0,0,0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return 'Rp ' + value.toLocaleString('id-ID');
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0,0,0,0.05)'
                            }
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk mengubah timeframe grafik
        function changeTimeframe(timeframe) {
            currentTimeframe = timeframe;
            
            // Update tombol aktif
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update data grafik
            const data = historicalData[timeframe];
            chart.data.labels = data.labels;
            chart.data.datasets[0].data = data.prices;
            chart.data.datasets[0].borderColor = data.color;
            chart.data.datasets[0].backgroundColor = data.color + '20';
            chart.data.datasets[0].pointBackgroundColor = data.color;
            chart.update();
        }
        
        // Fungsi untuk memuat daftar sumber data
        function loadSources() {
            const sourcesList = document.getElementById('sources-list');
            sourcesList.innerHTML = '';
            
            goldSources.forEach(source => {
                const changeClass = source.change >= 0 ? 'positive' : 'negative';
                const changeIcon = source.change >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                
                const sourceItem = document.createElement('div');
                sourceItem.className = 'source-item';
                sourceItem.innerHTML = `
                    <div class="source-logo" style="background-color: ${source.color}20; color: ${source.color};">
                        <i class="${source.icon}"></i>
                    </div>
                    <div class="source-info">
                        <div class="source-name">${source.name}</div>
                        <div class="current-price" style="font-size: 1.2rem; margin: 5px 0;">
                            Rp ${source.price.toLocaleString('id-ID')}
                        </div>
                        <div class="source-status active">
                            <span class="price-change ${changeClass}" style="font-size: 0.9rem; padding: 2px 8px;">
                                <i class="fas ${changeIcon}"></i> ${Math.abs(source.change)}%
                            </span>
                            ‚Ä¢ <i class="fas fa-circle" style="font-size: 0.5rem; color: #27ae60;"></i> Live
                        </div>
                    </div>
                `;
                
                sourcesList.appendChild(sourceItem);
            });
        }
        
        // Fungsi untuk memperbarui data harga dari semua sumber
        function updateGoldPrices() {
            if (!autoUpdate) return;
            
            updateCount++;
            
            // Simulasi perubahan harga dari berbagai sumber
            let totalPrice = 0;
            let highestPrice = 0;
            let lowestPrice = Infinity;
            let priceChanges = [];
            
            goldSources.forEach(source => {
                // Simulasi perubahan harga acak
                const changePercent = (Math.random() - 0.5) * 0.3;
                const changeAmount = Math.round(source.price * changePercent / 100);
                source.price += changeAmount;
                source.change = changePercent;
                
                // Update total untuk rata-rata
                totalPrice += source.price;
                
                // Update harga tertinggi dan terendah
                if (source.price > highestPrice) highestPrice = source.price;
                if (source.price < lowestPrice) lowestPrice = source.price;
                
                // Simpan perubahan signifikan
                if (Math.abs(changePercent) > 0.2) {
                    priceChanges.push({
                        source: source.name,
                        change: changePercent,
                        price: source.price
                    });
                }
            });
            
            // Hitung rata-rata
            const averagePrice = Math.round(totalPrice / goldSources.length);
            const prevAverage = parseInt(document.getElementById('gold-price').textContent.replace(/,/g, ''));
            const averageChange = averagePrice - prevAverage;
            const averageChangePercent = ((averageChange / prevAverage) * 100).toFixed(2);
            
            // Update tampilan harga rata-rata
            document.getElementById('gold-price').textContent = averagePrice.toLocaleString('id-ID');
            
            const changeClass = averageChange >= 0 ? 'positive' : 'negative';
            const changeIcon = averageChange >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
            document.getElementById('price-change').innerHTML = `
                <i class="fas ${changeIcon}"></i> 
                Rp ${Math.abs(averageChange).toLocaleString('id-ID')} 
                (${averageChange >= 0 ? '+' : ''}${averageChangePercent}%)
            `;
            document.getElementById('price-change').className = `price-change ${changeClass}`;
            
            // Update harga tertinggi dan terendah
            document.getElementById('highest-price').textContent = `Rp ${highestPrice.toLocaleString('id-ID')}`;
            document.getElementById('lowest-price').textContent = `Rp ${lowestPrice.toLocaleString('id-ID')}`;
            document.getElementById('price-difference').textContent = `Rp ${(highestPrice - lowestPrice).toLocaleString('id-ID')}`;
            
            // Update indikator pasar
            updateMarketIndicator(averageChangePercent, priceChanges.length);
            
            // Update grafik dengan data terbaru
            updateChartData(averagePrice);
            
            // Update daftar sumber
            loadSources();
            
            // Update perubahan terkini
            updateRecentChanges(priceChanges);
            
            // Update waktu terakhir pembaruan
            updateLastUpdateTime();
            
            // Update timer
            updateUpdateTimer();
            
            // Simpan perubahan signifikan untuk notifikasi
            if (priceChanges.length > 0 && updateCount % 3 === 0) {
                showPriceChangeNotification(priceChanges);
            }
        }
        
        // Fungsi untuk memperbarui indikator pasar
        function updateMarketIndicator(changePercent, significantChanges) {
            const indicator = document.getElementById('market-indicator');
            const indicatorText = document.querySelector('.indicator-text');
            const indicatorIcon = document.querySelector('.indicator-icon i');
            const volatility = document.getElementById('volatility');
            const trend = document.getElementById('trend');
            const risk = document.getElementById('risk');
            const consensus = document.getElementById('consensus');
            
            // Tentukan status pasar berdasarkan perubahan
            let marketSafe = Math.abs(changePercent) < 0.5 && significantChanges < 3;
            
            if (marketSafe) {
                // Status aman/stabil
                indicator.className = 'indicator safe';
                indicatorText.textContent = 'Pasar Stabil';
                indicatorIcon.className = 'fas fa-shield-alt';
                
                // Update informasi terkait
                volatility.textContent = Math.abs(changePercent) < 0.3 ? 'Rendah' : 'Sedang';
                volatility.className = 'value';
                
                trend.textContent = changePercent >= 0 ? 'Naik' : 'Turun';
                trend.className = changePercent >= 0 ? 'value positive' : 'value negative';
                
                risk.textContent = 'Rendah';
                risk.className = 'value';
                
                consensus.textContent = 'Stabil';
                consensus.className = 'value positive';
                
            } else {
                // Status tidak aman/volatile
                indicator.className = 'indicator unsafe';
                indicatorText.textContent = 'Pasar Volatile';
                indicatorIcon.className = 'fas fa-exclamation-triangle';
                
                // Update informasi terkait
                volatility.textContent = 'Tinggi';
                volatility.className = 'value negative';
                
                trend.textContent = changePercent >= 0 ? 'Naik Cepat' : 'Turun Cepat';
                trend.className = changePercent >= 0 ? 'value positive' : 'value negative';
                
                risk.textContent = 'Tinggi';
                risk.className = 'value negative';
                
                consensus.textContent = 'Berfluktuasi';
                consensus.className = 'value negative';
            }
            
            // Update rentang harga di grafik
            updatePriceRangeVisualization();
        }
        
        // Fungsi untuk memperbarui visualisasi rentang harga
        function updatePriceRangeVisualization() {
            const currentPrice = parseInt(document.getElementById('gold-price').textContent.replace(/,/g, ''));
            const highestPrice = parseInt(document.getElementById('highest-price').textContent.replace(/[^0-9]/g, ''));
            const lowestPrice = parseInt(document.getElementById('lowest-price').textContent.replace(/[^0-9]/g, ''));
            
            const range = highestPrice - lowestPrice;
            const position = ((currentPrice - lowestPrice) / range) * 100;
            
            document.getElementById('price-range-bar').style.width = `${position}%`;
            document.getElementById('current-price-marker').style.left = `${position}%`;
        }
        
        // Fungsi untuk memperbarui data grafik
        function updateChartData(currentPrice) {
            // Tambahkan data terbaru ke grafik
            const currentData = historicalData[currentTimeframe];
            
            if (currentTimeframe === '24h') {
                // Untuk grafik 24 jam, geser data dan tambahkan yang baru
                currentData.prices.shift();
                currentData.prices.push(currentPrice);
                
                // Update grafik
                chart.data.datasets[0].data = currentData.prices;
                chart.update();
            } else if (updateCount % 10 === 0) {
                // Untuk timeframe lain, update secara berkala
                currentData.prices[currentData.prices.length - 1] = currentPrice;
                chart.data.datasets[0].data = currentData.prices;
                chart.update();
            }
        }
        
        // Fungsi untuk memperbarui perubahan terkini
        function updateRecentChanges(priceChanges) {
            const recentChanges = document.getElementById('recent-changes');
            
            if (priceChanges.length === 0) {
                recentChanges.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                        <i class="fas fa-check-circle" style="color:#27ae60; font-size: 2rem; margin-bottom: 10px;"></i>
                        <p>Tidak ada perubahan signifikan dalam 10 detik terakhir</p>
                    </div>
                `;
                return;
            }
            
            let changesHTML = '<ul class="info-list">';
            
            priceChanges.slice(0, 4).forEach(change => {
                const changeClass = change.change >= 0 ? 'positive' : 'negative';
                const changeIcon = change.change >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                const timeAgo = `${Math.floor(Math.random() * 9) + 1} detik lalu`;
                
                changesHTML += `
                    <li>
                        <span class="label">
                            <i class="fas ${changeIcon} ${changeClass}"></i> ${change.source}
                        </span>
                        <div style="text-align: right;">
                            <div class="value ${changeClass}">${change.change >= 0 ? '+' : ''}${change.change.toFixed(2)}%</div>
                            <div style="font-size: 0.8rem; color: #7f8c8d;">${timeAgo}</div>
                        </div>
                    </li>
                `;
            });
            
            changesHTML += '</ul>';
            recentChanges.innerHTML = changesHTML;
        }
        
        // Fungsi untuk menampilkan notifikasi perubahan harga
        function showPriceChangeNotification(priceChanges) {
            // Hanya tampilkan jika halaman aktif
            if (document.hidden) return;
            
            const mainChange = priceChanges[0];
            const changeType = mainChange.change >= 0 ? 'kenaikan' : 'penurunan';
            const changeIcon = mainChange.change >= 0 ? 'üìà' : 'üìâ';
            
            // Buat notifikasi desktop
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification(`${changeIcon} Perubahan Harga Emas`, {
                    body: `${mainChange.source}: ${Math.abs(mainChange.change).toFixed(2)}% ${changeType}`,
                    icon: 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'
                });
            }
            
            // Tampilkan notifikasi di halaman
            showToastNotification(`${changeIcon} ${mainChange.source}: ${Math.abs(mainChange.change).toFixed(2)}% ${changeType}`);
        }
        
        // Fungsi untuk menampilkan notifikasi toast
        function showToastNotification(message) {
            // Hapus notifikasi sebelumnya
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) existingToast.remove();
            
            // Buat elemen notifikasi baru
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.innerHTML = `
                <div style="background-color: white; padding: 15px 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
                         display: flex; align-items: center; gap: 10px; animation: slideIn 0.3s ease;">
                    <i class="fas fa-bell" style="color: #e74c3c;"></i>
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="margin-left: auto; background: none; border: none; cursor: pointer; color: #7f8c8d;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            // Tambahkan style untuk animasi
            const style = document.createElement('style');
            style.textContent = `
                .toast-notification {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 1000;
                }
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(toast);
            
            // Hapus notifikasi setelah 5 detik
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }
        
        // Fungsi untuk memperbarui waktu terakhir update
        function updateLastUpdateTime() {
            lastUpdateTime = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'Asia/Jakarta',
                timeZoneName: 'short'
            };
            document.getElementById('last-update').textContent = lastUpdateTime.toLocaleDateString('id-ID', options);
        }
        
        // Fungsi untuk memperbarui timer
        function updateUpdateTimer() {
            const now = new Date();
            const diff = Math.floor((now - lastUpdateTime) / 1000);
            document.getElementById('update-timer').textContent = `${diff} detik lalu`;
        }
        
        // Fungsi untuk memulai/menghentikan auto-update
        function toggleAutoUpdate() {
            autoUpdate = !autoUpdate;
            const toggle = document.getElementById('auto-update-toggle');
            toggle.checked = autoUpdate;
            
            if (autoUpdate) {
                startAutoUpdate();
                showToastNotification('üîÑ Auto-update diaktifkan');
            } else {
                stopAutoUpdate();
                showToastNotification('‚è∏Ô∏è Auto-update dihentikan');
            }
        }
        
        // Fungsi untuk memulai auto-update
        function startAutoUpdate() {
            if (updateInterval) clearInterval(updateInterval);
            updateInterval = setInterval(updateGoldPrices, 10000); // Update setiap 10 detik
            
            // Update timer setiap detik
            if (window.timerInterval) clearInterval(window.timerInterval);
            window.timerInterval = setInterval(updateUpdateTimer, 1000);
        }
        
        // Fungsi untuk menghentikan auto-update
        function stopAutoUpdate() {
            if (updateInterval) clearInterval(updateInterval);
            if (window.timerInterval) clearInterval(window.timerInterval);
        }
        
        // Minta izin notifikasi
        function requestNotificationPermission() {
            if ("Notification" in window && Notification.permission === "default") {
                Notification.requestPermission();
            }
        }
        
        // Inisialisasi saat halaman dimuat
        window.onload = function() {
            initChart();
            loadSources();
            updatePriceRangeVisualization();
            startAutoUpdate();
            requestNotificationPermission();
            
            // Update awal
            updateGoldPrices();
            
            // Setup event listener untuk toggle auto-update
            document.getElementById('auto-update-toggle').addEventListener('change', toggleAutoUpdate);
            
            // Setup event listener untuk visibility change
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden && autoUpdate) {
                    updateGoldPrices();
                }
            });
        };
    </script>
</body>
</html>
